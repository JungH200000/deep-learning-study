# Encoder와 Decoder

이미지와 텍스트 같이 사람이 이해할 수 있는 다양한 데이터로부터 수많은 정보를 추출하고자 한다. 그러나 컴퓨터는 이미지를 픽셀별 RGB 수치 값으로만 받아들이기 때문에 사람이 해석하는 여러 정보를 컴퓨터가 이해할 수 있게 하려면 컴퓨터가 이해할 수 있는 형태로 정보를 변환하는 과정이 필요하다. 이 변환 과정에서 Encoder(인코더)와 Decoder(디코더)라는 구조가 핵심적인 역할을 하게 된다.

## Encoder (인코더)

인간이 직관적으로 확인할 수 있는 구체적인 정보를 추상적인 형태로 변환시키는 형태를 말한다. 입력 데이터를 저차원의 추상적인 데이터로 압축하여 기존 데이터의 중요한 특성을 포착하고 보존하는 것이다.

## Decoder (디코더)

인코더의 반대 역할을 수행한다. 추상적인 형태에서 다시 인간이 해석할 수 있는 형태의 구체적인 정보로 변환시킨다. 저차원으로 압축된 추상적 표현을 다시 고차원 형태로 복원시키는 구조이다.

---

딥 러닝 모델 내에서 인코더와 디코더의 역할을 이해하기 위해서 앞에서 공부했던 RNN 구조 중 many to one, one to many 구조를 살펴보자.

---

## many to one

<img src="../images/many-to-one.png" width=450>

RNN의 many to one 구조는 시퀀스를 이루는 다수의 입력을 받아 하나의 출력을 생성하는 구조를 말한다. 이렇게 많은 양의 정보를 하나의 값으로 압축시키는 기능을 하는 many to one 구조는 인코더의 역할을 수행한다고 볼 수 있다.

## on to many

<img src="../images/one-to-many.png" width=450>

반면 RNN의 one to many 구조는 하나의 입력으로 다수의 출력을 생성하는 구조인데 이는 디코더의 역할을 수행하는 것으로 볼 수 있다.

---

RNN에서의 예시처럼 딥 러닝에서 인코더는 입력 데이터를 고정된 길이의 벡터 형태의 내부 표현으로 압축시켜 이를 통해 데이터를 효율적으로 표현한다. 이런 변환 과정에서 차원이 축소되어 불필요한 정보를 제거함으로써 데이터의 특징을 잘 포착할 수 있다. 디코더는 데이터의 특징이 축약된 내부 표현을 다시 원시 데이터의 형태로 복원하거나 원하는 다른 형태로 변환하여 출력한다. 이를 통해 기계 번역에서 원하는 언어의 텍스트 데이터를 추출하는 것처럼 원하는 형태의 결과를 최종적으로 얻을 수 있다.

---

예시: 숫자 3을 나타내는 그림과 숫자 6을 나타내는 그림 데이터를 가지고 두 숫자의 합을 그림으로 나타내고 싶다면 어떻게 해야 할까??

그림으로 표현된 3과 6을 컴퓨터는 직관적인 숫자로 이해할 수 없기 때문에 그림 데이터를 가지고 수행하는 연산은 아주 복잡하거나 불가능할 수도 있다. 이 문제에 인코더, 디코더 구조를 활용한다면 어떨까??

먼저 3과 6 그림을 인코더에 통과 시켜 각각을 표현하는 압축된 표현을 얻는다. 압축된 표현을 가지고 간단한 연산을 수행하여 숫자 9를 의미하는 표현을 도출할 수 있다. 그리고 이 표현을 다시 디코더에 통과시키면 9에 대한 그림 표현으로 복원되어 원하는 결과를 얻을 수 있다.

---

이렇게 딥 러닝에서는 인코더를 통해 압축된 내부 표현을 가지고 필요한 작업을 효율적으로 수행한 뒤 디코더로 원하는 결과물을 얻을 수 있게 된다.

딥 러닝에서 이런 인코더와 디코더 기능을 활용하면 노이즈가 존재하는 이미지를 복원하는 과정에서 노이즈가 제거된 사진을 얻을 수도 있다.
